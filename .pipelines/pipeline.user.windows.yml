environment:
  host:
    os: 'windows'
    flavor: 'server'
    version: '2019'
  runtime:
    provider: 'appcontainer'
    image: 'cdpxwin1809.azurecr.io/global/vse2019:latest'
    source_mode: 'map'
restore:
  commands:
    - !!defaultcommand
      name: 'Install Java 11 JDK'
      command: '.scripts/installJava11jdk.cmd'
    - !!defaultcommand
      name: 'Install Java 7 JRE'
      command: '.scripts/installJava7jre.cmd'
    - !!defaultcommand
      name: 'Clean and Resolve Dependencies'
      command: '.scripts/gradle.cmd'
      arguments: ':core:clean :core:resolveDependencies --info --stacktrace --refresh-dependencies'
build:
  commands:
    - !!buildcommand
      name: 'Assemble ApplicationInsights-Java projects'
      command: '.scripts/gradle.cmd'
      arguments: ':core:assemble --info --stacktrace -DskipWinNative=true'
      artifacts:
        - from: 'core/build/libs'
          to: 'build/artifacts'
          include:
            - '*.jar'
test:
  commands:
    - !!testcommand
      name: 'Test ApplicationInsights-Java projects'
      command: '.scripts/gradle.cmd'
      arguments: ':core:check --info --stacktrace -DskipWinNative=true'
      testresults:
        - from: 'core/build/test-results/test'
          include:
            - '*.xml'
